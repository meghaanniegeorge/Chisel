circuit PWM : @[:@2.0]
  module PWM : @[:@3.2]
    input clock : Clock @[:@4.4]
    input reset : UInt<1> @[:@5.4]
    input io_rise : UInt<2> @[:@6.4]
    input io_fall : UInt<2> @[:@6.4]
    output io_out : UInt<1> @[:@6.4]
  
    reg counter : UInt<2>, clock with :
      reset => (UInt<1>("h0"), counter) @[PWM.scala 15:30:@8.4]
    reg out : UInt<1>, clock with :
      reset => (UInt<1>("h0"), out) @[PWM.scala 16:26:@9.4]
    node _T_15 = eq(counter, io_rise) @[PWM.scala 18:31:@10.4]
    node _T_16 = eq(counter, io_fall) @[PWM.scala 18:49:@11.4]
    node _T_17 = mux(out, _T_15, _T_16) @[PWM.scala 18:17:@12.4]
    node _T_20 = eq(out, UInt<1>("h0")) @[PWM.scala 20:24:@15.6]
    node _T_22 = add(counter, UInt<1>("h1")) @[PWM.scala 22:36:@19.6]
    node _T_23 = tail(_T_22, 1) @[PWM.scala 22:36:@20.6]
    node _GEN_0 = mux(_T_17, UInt<1>("h1"), _T_23) @[PWM.scala 18:59:@13.4]
    node _GEN_1 = mux(_T_17, _T_20, out) @[PWM.scala 18:59:@13.4]
    io_out <= out @[PWM.scala 25:16:@23.4]
    counter <= mux(reset, UInt<2>("h0"), _GEN_0) @[PWM.scala 19:25:@14.6 PWM.scala 22:25:@21.6]
    out <= mux(reset, UInt<1>("h1"), _GEN_1) @[PWM.scala 20:21:@16.6]
